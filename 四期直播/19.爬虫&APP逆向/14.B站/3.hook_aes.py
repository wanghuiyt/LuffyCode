import sys
import frida

rdev = frida.get_remote_device()
session = rdev.attach("哔哩哔哩")

scr = """
Java.perform(function () {
    var b = Java.use("t3.a.i.a.a.a.b");

    b.a.implementation = function(body){
        console.log("传入参数：", body);
        var res = this.a(body);
        console.log("加密后=",res);
        var str_hex = JSON.stringify(res);
        console.log(str_hex);
        return res;
    }
});
"""

script = session.create_script(scr)

script.load()
sys.stdin.read()
# 传入参数： aid=339766768&auto_play=0&build=6240300&cid=549655372&did=Lhp8SitJf0dwR3ZAc0JySws5CDgBMAEwBkcE&epid=&from_spmid=tm.recommend.0.0&ftime=1662674999&lv=0&mid=0&mobi_app=android&part=0&sid=0&spmid=main.ugc-video-detail-vertical.0.0&stime=1662679930&sub_type=0&type=3&sign=51ad2662be549c9519d74ea496bdebece0e004a4e78473e3ea9d840d286d320b
# [-60,24,75,77,35,-96,-11,56,85,29,-5,103,103,-104,-128,-21,90,47,113,-81,64,61,12,126,-99,-102,90,-20,-98,-71,-86,-70,64,9,-128,-115,-52,-63,-71,86,-44,-44,-106,10,-54,-98,-101,-115,-41,-1,87,24,105,79,75,-71,46,-23,115,45,-128,-60,67,-51,-41,124,29,19,-53,1,96,13,-2,117,49,-82,-67,85,84,-95,-11,-51,100,121,46,-40,16,-90,-120,99,1,-29,14,66,87,-16,-110,99,104,116,-90,119,-7,-67,42,81,-50,-117,-76,99,-41,-101,70,-23,117,82,-11,43,73,7,93,-35,124,-104,-14,-74,-112,90,-20,119,-4,14,-102,106,38,11,-24,48,59,-10,-119,53,-82,46,23,60,-34,119,107,73,23,-110,-42,80,1,116,-8,-59,5,-77,127,-7,51,18,124,106,-82,-108,62,107,79,10,15,113,-60,-26,-67,-35,19,23,-17,-125,-57,-62,75,39,-92,28,77,-16,85,-60,-11,-63,78,-109,-70,88,-116,-22,-92,8,-118,41,-53,-112,-69,4,-118,2,67,-105,85,-67,-1,-53,-11,11,78,115,-57,121,-119,-15,-18,-63,-56,-94,18,-46,117,90,-125,-62,-50,103,-47,74,84,82,-87,26,41,71,55,-106,18,40,104,-65,-23,-85,-70,-43,66,-108,103,49,113,-27,5,-69,-6,-89,-121,67,24,97,105,34,-104,9,112,41,-1,8,-2,84,-43,-35,-103,66,-93,16,74,6,55,94,63,-122,103,-51,28,52,69,87,-23,-38,-43,-40,70,97,6,119,-62,0,41,-77,-20,53,81,-41,117,-69,-95,-119,-113,48,-97,64,-109,119,107,-50,110,15,98,-104,78,-23,35,-38,123,-4,74,-51]
