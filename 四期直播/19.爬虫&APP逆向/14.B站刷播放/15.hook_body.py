import sys
import frida

rdev = frida.get_remote_device()
session = rdev.attach("哔哩哔哩")

scr = """
Java.perform(function() {
    var d = Java.use("tv.danmaku.biliplayerimpl.report.heartbeat.d");
    var b = Java.use("t3.a.i.a.a.a.b");
    
    
    d.H7.implementation = function(j2,j4,i2,j5,j6,i3,i4,j7,str,i5,str2,str3){
        console.log("j2=>",j2);
        console.log("j4=>",j4);
        console.log("i2=>",i2)
        console.log("j5=>",j5);
        console.log("j6=>",j6);
        console.log("i3=>",i3);
        console.log("i4=>",i4);
        console.log("j7=>",j7);
        console.log("str=>",str);
        console.log("i5=>",i5);
        console.log("str2=>",str2);
        console.log("str3=>",str3);
        var res = this.H7(j2,j4,i2,j5,j6,i3,i4,j7,str,i5,str2,str3);
        return res;
    }
    
    b.a.implementation = function(str){
        console.log("body=>", str);
        var res = this.a(str);
        console.log("加密后结果=>",res);
        return res;
    }
});
"""

script = session.create_script(scr)


def on_message(message, data):
    print(message, data)


script.on("message", on_message)
script.load()
sys.stdin.read()

# j2=> 560104579
# j4=> 818901372
# i2=> 1
# j5=> 1662801533
# j6=> 1662799838
# i3=> 3
# i4=> 0
# j7=> 0
# str=>
# i5=> 0
# str2=> main.ugc-video-detail.0.0
# str3=> tm.recommend.0.0
# body=> aid=560104579&auto_play=0&build=6240300&cid=818901372&did=Lhp8SitJf0dwR3ZAc0JySws5CDgBMAEwBkcE&epid=&from_spmid=tm.recommend.0.0&ftime=1662799838&lv=0&mid=0&mobi_app=android&part=1&sid=0&spmid=main.ugc-video-detail.0.0&stime=1662801533&sub_type=0&type=3&sign=c8fb4f590b39979265dc5e8fe7c3136e9d4e1f2d87c5e626b34f495147d530f7

# j2=> 429514636
# j4=> 804070582
# i2=> 1
# j5=> 1662866217
# j6=> 1662866217
# i3=> 3
# i4=> 0
# j7=> 0
# str=>
# i5=> 0
# str2=> main.ugc-video-detail.0.0
# str3=> tm.recommend.0.0
# body=> aid=429514636&auto_play=0&build=6240300&cid=804070582&did=Lhp8SitJf0dwR3ZAc0JySws5CDgBMAEwBkcE&epid=&from_spmid=tm.recommend.0.0&ftime=1662866217&lv=0&mid=0&mobi_app=android&part=1&sid=0&spmid=main.ugc-video-detail.0.0&stime=1662866217&sub_type=0&type=3&sign=b0b2b03cfbc3c37feb99d2b84e3dfaf1a18e6b77c296754674824b56bdf58270
# 加密后结果=> -105,42,-60,-116,74,11,-53,70,32,4,51,-75,19,51,-90,-66,-103,-75,-41,-42,101,-62,-47,-110,-127,-115,110,75,-71,-126,9,8,90,65,-103,-40,-79,-32,54,-69,100,-95,16,-52,-51,-41,39,-53,-7,110,126,112,-68,-74,24,-78,-39,-39,-74,-12,97,30,5,-99,-56,-99,116,-25,-85,66,110,-117,-74,-110,112,-98,3,68,24,-55,113,-112,71,63,-83,-2,-68,108,-23,-21,-2,-106,127,-20,-120,-86,13,-30,-72,-54,-46,-33,-59,41,85,13,94,74,109,-78,11,-38,-38,108,-5,35,42,-2,-30,-68,-79,83,127,-47,-81,53,33,-28,89,-62,-91,-80,61,-57,-22,56,114,-93,-11,55,41,-128,-119,64,-61,88,99,11,-102,-98,71,78,-17,118,-39,-111,77,32,104,-104,123,-1,-3,-126,-74,-99,24,15,-28,27,94,-38,-100,28,58,-79,7,-44,-81,-43,-97,92,-112,103,-121,64,18,74,-89,74,-106,-50,-80,105,-70,-53,110,69,-83,-45,-21,-85,99,-88,46,12,76,53,33,80,100,-109,-82,-5,46,-125,32,-122,-47,-74,-59,110,11,123,-37,-32,-31,98,95,54,52,-110,102,101,43,70,69,95,-27,-86,-110,-121,42,-10,81,92,16,127,101,-13,-64,1,26,45,-122,-10,-123,24,8,92,108,-55,49,126,-125,72,-68,-78,7,-60,-103,105,122,15,97,7,-55,50,-8,99,104,31,-121,64,109,-16,-58,-9,-65,-3,127,-78,-31,125,-101,-51,105,-65,22,-88,57,-49,-54,42,74,-17,64,113,-108,99,13,98,-108,49,78,-116,-26,65,-84,-98,32,113,113,20,-91,-37,75,58,49,-120,-32,37,-116,96,97,16
#             [151, 42, 196, 140, 74, 11, 203, 70, 32, 4, 51, 181, 19, 51, 166, 190, 153, 181, 215, 214, 101, 194, 209, 146, 129, 141, 110, 75, 185, 130, 9, 8, 90, 65, 153, 216, 177, 224, 54, 187, 100, 161, 16, 204, 205, 215, 39, 203, 249, 110, 126, 112, 188, 182, 24, 178, 217, 217, 182, 244, 97, 30, 5, 157, 200, 157, 116, 231, 171, 66, 110, 139, 182, 146, 112, 158, 3, 68, 24, 201, 113, 144, 71, 63, 173, 254, 188, 108, 233, 235, 254, 150, 127, 236, 136, 170, 13, 226, 184, 202, 210, 223, 197, 41, 85, 13, 94, 74, 109, 178, 11, 218, 218, 108, 251, 35, 42, 254, 226, 188, 177, 83, 127, 209, 175, 53, 33, 228, 89, 194, 165, 176, 61, 199, 234, 56, 114, 163, 245, 55, 41, 128, 137, 64, 195, 88, 99, 11, 154, 158, 71, 78, 239, 118, 217, 145, 77, 32, 104, 152, 123, 255, 253, 130, 182, 157, 24, 15, 228, 27, 94, 218, 156, 28, 58, 177, 7, 212, 175, 213, 159, 92, 144, 103, 135, 64, 18, 74, 167, 74, 150, 206, 176, 105, 186, 203, 110, 69, 173, 211, 235, 171, 99, 168, 46, 12, 76, 53, 33, 80, 100, 147, 174, 251, 46, 131, 32, 134, 209, 182, 197, 110, 11, 123, 219, 224, 225, 98, 95, 54, 52, 146, 102, 101, 43, 70, 69, 95, 229, 170, 146, 135, 42, 246, 81, 92, 16, 127, 101, 243, 192, 1, 26, 45, 134, 246, 133, 24, 8, 92, 108, 201, 49, 126, 131, 72, 188, 178, 7, 196, 153, 105, 122, 15, 97, 7, 201, 50, 248, 99, 104, 31, 135, 64, 109, 240, 198, 247, 191, 253, 127, 178, 225, 125, 155, 205, 105, 191, 22, 168, 57, 207, 202, 42, 74, 239, 64, 113, 148, 99, 13, 98, 148, 49, 78, 140, 230, 65, 172, 158, 32, 113, 113, 20, 165, 219, 75, 58, 49, 136, 224, 37, 140, 96, 97, 16]
