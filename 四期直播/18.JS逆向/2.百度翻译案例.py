from functools import partial
import subprocess
subprocess.Popen = partial(subprocess.Popen, encoding="utf-8")
import execjs
import requests

url = "https://fanyi.baidu.com/v2transapi?from=en&to=zh"

headers = {
    "Referer": "https://fanyi.baidu.com/",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",
    'Cookie': 'H_WISE_SIDS=110085_127969_184716_185634_189755_191067_191249_194085_194511_195342_196427_196527_197242_197471_197711_197956_198262_199177_199582_200993_201193_201535_202544_203310_203360_203504_203517_203985_204031_204123_204131_204254_204305_204779_204860_204905_204950_205077_205218_205219_205240_205383_205414_205484_205959_206008_206515_206682_206728_206767_206871_206942_207122_207178_207234_207272_207363_207609_207610_207625_207766_207864_207888_208054_208226_208255_208267_208271_208367_208489_208555; BIDUPSID=506B54ADFBD549863C86E8B20A1F78C5; PSTM=1649379228; BAIDUID=506B54ADFBD549863C86E8B20A1F78C5:SL=0:NR=50:FG=1; REALTIME_TRANS_SWITCH=1; HISTORY_SWITCH=1; FANYI_WORD_SWITCH=1; SOUND_SPD_SWITCH=1; SOUND_PREFER_SWITCH=1; BDUSS=m5rc0JFOTN0fkFyRzljWXU1UEw2NzJWczN2MmdhZDNOYmNVZWRGdHZrOVA0ZWhpSUFBQUFBJCQAAAAAAQAAAAEAAADnHPZm9s7KsbT6s8zQ8tSxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE9UwWJPVMFiZ; BDUSS_BFESS=m5rc0JFOTN0fkFyRzljWXU1UEw2NzJWczN2MmdhZDNOYmNVZWRGdHZrOVA0ZWhpSUFBQUFBJCQAAAAAAQAAAAEAAADnHPZm9s7KsbT6s8zQ8tSxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE9UwWJPVMFiZ; ZFY=FStJ1lzbDX:AaF82e8WOAXhpT7Va4jeg9gXk:Am7ncgP0:C; BAIDUID_BFESS=506B54ADFBD549863C86E8B20A1F78C5:SL=0:NR=50:FG=1; H_WISE_SIDS_BFESS=110085_127969_184716_185634_189755_191067_191249_194085_194511_195342_196427_196527_197242_197471_197711_197956_198262_199177_199582_200993_201193_201535_202544_203310_203360_203504_203517_203985_204031_204123_204131_204254_204305_204779_204860_204905_204950_205077_205218_205219_205240_205383_205414_205484_205959_206008_206515_206682_206728_206767_206871_206942_207122_207178_207234_207272_207363_207609_207610_207625_207766_207864_207888_208054_208226_208255_208267_208271_208367_208489_208555; APPGUIDE_10_0_2=1; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1661052057; RT="z=1&dm=baidu.com&si=otundzzwgiq&ss=l72ribih&sl=1&tt=4ls&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=5ei&ul=7ue&hd=7ut"; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1661052942; ab_sr=1.0.1_YTViY2FjNDVjNjc1ZTg3NDBjZjVlYzYzNjIyYWE3NmE3MmRmMjBkNTQyNzUyNzM2M2U5NTdhYWE1ZDY0NGJkYWVjNzdiNzhjNjA5ODlkMWZmNGQyMWJkNGM2ODJlOGY4MGJjMmU2ZTZjMjhkMTA0OTY0YTgwZjBlZWY1ZGZkNWYwNWFmOWUxMTRjYmE0ZjJlYzg0MzVkZjRkMDg0YjIxNzY4NzE5ZjRkMWYxNmYyZjc4NTFiN2RkYjkxYzEyMTFl'
}

word = input("请输入一个单词：")

with open("bdfy.js", mode="r", encoding="utf-8") as f:
    js = f.read()
obj = execjs.compile(js)
sign = obj.call("tl", word)
print(sign)
data = {
    "from": "en",
    "to": "zh",
    "query": word,
    "transtype": "realtime",
    "simple_means_flag": 3,
    "sign": sign,
    "token": "c4101f8d7b23c75c21f80333e81b754f",
    "domain": "common"
}

resp = requests.post(url, headers=headers, data=data)
print(resp.json())
